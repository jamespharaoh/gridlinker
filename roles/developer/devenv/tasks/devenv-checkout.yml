---

- name: "checkout projects from git"
  with_items: "{{ devenv_checkouts | map (attribute = 'name') | list }}"
  when: "deployment_mode == 'vagrant'"
  args:

    executable: "/bin/bash"
    creates: "{{ deployment_home }}/{{ item }}"

  shell:

    set -euf -o pipefail;

    cd {{ deployment_home }};

    git clone
      {{ git_base_url }}/{{ item }}
      --branch {{
        devenv_checkouts
          | selectattr ('name', 'equalto', item)
          | map (attribute = 'branch')
          | first
        }};

# ex: et ts=2 filetype=yaml
