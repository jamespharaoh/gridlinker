---

- name: "create samba config"
  notify: "restart samba"
  become: "yes"
  action:

    module: "template"
    dest: "/etc/samba/smb.conf"
    src: "devbox-samba-config"

- name: "set samba password"
  args:

    creates: "/etc/samba/vagrant-password-flag"
    executable: "/bin/bash"

  become: "yes"
  shell:

    set -euf -o pipefail;

    printf "vagrant\nvagrant\n" | smbpasswd -a {{ vagrant_user }} -s;

    touch /etc/samba/vagrant-password-flag;

# ex: et ts=2 filetype=yaml
