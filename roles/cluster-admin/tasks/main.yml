---

- include_vars: "/home/vagrant/work/{{ cluster }}/cluster-data"
  tags:
    - "cluster-admin-activate"

# pre setup

- include: "cluster-admin-create.yml"
  tags:
    - "cluster-admin-create"
    - "cluster-admin-activate"

- include: "cluster-admin-assign-ip.yml"
  tags:
    - "cluster-admin-assign-ip"

- include: "cluster-admin-wait-for-ssh.yml"
  tags:
    - "cluster-admin-system"
    - "cluster-admin-openvpn"
    - "cluster-admin-firewall"
    - "cluster-admin-nginx"

# system setup

- include: "cluster-admin-system.yml"
  tags:
    - "cluster-admin-system"

- include: "cluster-admin-openvpn.yml"
  tags:
    - "cluster-admin-openvpn"

- include: "cluster-admin-firewall.yml"
  tags:
    - "cluster-admin-firewall"

- include: "cluster-admin-nginx.yml"
  tags:
    - "cluster-admin-nginx"

# post setup

- include: "cluster-admin-route.yml"
  tags:
    - "cluster-admin-route"

- include: "cluster-admin-activate.yml"
  tags:
    - "cluster-admin-activate"

# ex: et ts=2 filetype=yaml
