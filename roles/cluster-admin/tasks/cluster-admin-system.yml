---

- name: "set hostname"
  action:
    module: "copy"
    dest: "/etc/hostname"
    content: "{{ inventory_hostname }}{{ '\n' }}"
  sudo: "yes"
  notify: "set hostname"

- meta: "flush_handlers"

- name: "write hosts"
  action:
    module: "template"
    src: "cluster-admin-hosts"
    dest: "/etc/hosts"
  sudo: "yes"

- name: "remove system packages"
  action:
    module: "apt"
    state: "absent"
    name: "{{ item }}"
    purge: "yes"
  sudo: "yes"
  sudo_user: "root"
  with_items: "cluster_admin_remove_packages"
  tags: "update"

- name: "install system packages"
  action:
    module: "apt"
    state: "present"
    name: "{{ item }}"
  sudo: "yes"
  sudo_user: "root"
  with_items: "cluster_admin_install_packages"
  tags: "update"

# ex: et ts=2 filetype=yaml
