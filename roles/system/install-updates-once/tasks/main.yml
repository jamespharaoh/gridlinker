---

- register: "install_updates_once_flag"
  become: "yes"
  action:

    module: "stat"
    path: "/etc/install-updates-once-flag"

- name: "upgrade system packages"
  when: "not install_updates_once_flag.stat.exists"
  become: "yes"
  action:

    module: "apt"
    update_cache: "yes"
    upgrade: "dist"

- when: "not install_updates_once_flag.stat.exists"
  become: "yes"
  action:

    module: "file"
    path: "/etc/install-updates-once-flag"
    state: "touch"

# ex: et ts=2 filetype=yaml
