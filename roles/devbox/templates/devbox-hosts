127.0.0.1 localhost

{% if deployment_mode == 'vagrant' %}

# ---------- shortcut hosts for dev only

{% for host_name in groups.all if host_name in groups.node %}
{% set host = hostvars [host_name] %}
{% set host_address = [
	deployment_bridge_network,
	host.grp,
	host.idx,
] | join ('.') %}
{{ [
	deployment_bridge_network + '.' + (host.grp | string) + '.' + (host.idx | string),
	deployment + '-' + host_name,
	host_name,
	host_name + '.dev.wistla.com',
] | join (' ') }}
{% endfor %}

{% for subdomain in [ 'api' ] %}
{% for host_name in groups ['load-node'] %}
{% set host = hostvars [host_name] %}
{% set host_address = [
	deployment_bridge_network,
	host.grp,
	host.idx,
] | join ('.') %}
{{ [
	host_address,
	subdomain + '.dev.wistla.com',
] | join (' ') }}
{% endfor %}
{% endfor %}

{% endif %}

{% for other_deployment_name, other_deployment in deployments.items () %}

# ---------- deployment {{ other_deployment_name }}

{% for host_name in groups.all if host_name in groups.node %}
{% set host = hostvars [host_name] %}
{% set host_address = [
	other_deployment.bridge_network,
	host.grp,
	host.idx,
] | join ('.') %}
{{ [
	host_address,
	other_deployment_name + '-' + host_name,
	host_name + '.' + other_deployment.private_domain,
] | join (' ') }}
{% endfor %}

{% for host_name in groups ['load-node'] %}
{% set host = hostvars [host_name] %}
{% set host_address = [
	other_deployment.bridge_network,
	host.grp,
	host.idx,
] | join ('.') %}
{{ [
	host_address,
	other_deployment.private_domain,
] | join (' ') }}
{% endfor %}

{% for subdomain in [ 'api', 'www' ] %}
{% for host_name in groups ['load-node'] %}
{% set host = hostvars [host_name] %}
{% set host_address = [
	other_deployment.bridge_network,
	host.grp,
	host.idx,
] | join ('.') %}
{{ [
	host_address,
	subdomain + '.' + other_deployment.private_domain,
] | join (' ') }}
{% endfor %}
{% endfor %}

{% endfor %}

{% for cluster_name, cluster in clusters.items () %}

# ---------- cluster {{ cluster_name }}

{% for cluster_host_name in groups ['cluster-host'] %}
{% set cluster_host = hostvars [cluster_host_name] %}
{{ cluster.cluster_net }}.{{ cluster_subnets [cluster_host.cluster_type] [cluster_host.zon] }}.{{ cluster_host.idx }} {{ cluster_host_name }}.{{ cluster.cluster_domain }}
{% endfor %}

{% endfor %}
