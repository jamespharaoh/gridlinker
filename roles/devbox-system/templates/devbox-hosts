{%- print ansible_warning ['#'] + '\n\n' -%}

{%- print '127.0.0.1 localhost\n' -%}

{%- if deployment_mode == 'vagrant' -%}

	{%- print '\n# ---------- shortcut hosts for dev only\n\n' -%}

	{%- for host_name in groups.all if host_name in groups.node -%}

		{%- set host = hostvars [host_name] -%}

		{%- if 'private_address' in host -%}

			{%- print [
				host.private_address,
				host.node_type + '-' + host.node_index | string,
			] | join (' ') + '\n' -%}

		{%- endif -%}

	{%- endfor -%}

{%- endif -%}

{%- for other_deployment_name, other_deployment in deployments.items ()
if 'bridge_network' in other_deployment -%}

	{%- print '\n# ---------- deployment ', other_deployment_name, '\n\n' -%}

	{%- for host_name in groups.all if host_name in groups.node -%}

		{%- set host = hostvars [host_name] -%}

		{%- print [
			[
				other_deployment.bridge_network,
				node_type_indices [host.node_type],
				host.node_index,
			] | join ('.'),
			[
				other_deployment_name,
				host.node_type,
				host.node_index | string,
			] | join ('-'),
			[
				host.node_type + '-' + host.node_index | string,
				other_deployment.main_domain,
			] | join ('.'),
		] | join (' ') + '\n' -%}

	{%- endfor -%}

	{%- if other_deployment_name == deployment_name -%}

		{%- print '\n' -%}

		{%- for host_name in groups ['load-node'] -%}

			{%- set host = hostvars [host_name] -%}

			{%- print [
				[
					other_deployment.bridge_network,
					node_type_indices [host.node_type],
					host.node_index,
				] | join ('.'),
				other_deployment.main_domain,
				'api.' + other_deployment.main_domain,
				'www.' + other_deployment.main_domain,
			] | join (' ') + '\n' -%}

		{%- endfor -%}

	{%- endif -%}

{%- endfor -%}

{%- for cluster_name, cluster in clusters.items () -%}

	{%- print '\n# ---------- cluster ', cluster_name, '\n\n' -%}

	{%- for cluster_host_name in groups ['cluster-' + cluster_name] -%}

		{%- set cluster_host = hostvars [cluster_host_name] -%}

		{%- if 'private_address' in cluster_host -%}

			{%- print [
				cluster_host.private_address,
				cluster_host_name,
				cluster_host_name + '.' + cluster.main_domain,
			] | join (' ') + '\n' -%}

		{%- endif -%}

	{%- endfor -%}

{% endfor %}
