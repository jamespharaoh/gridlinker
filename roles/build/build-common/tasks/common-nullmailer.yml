---

- name: "configure nullmailer"
  with_items:

    - question: "nullmailer/relayhost"
      value: "10.69.132.1"
      type: "string"

    #- question: "shared/mailname"
    #  value: "???"
    #  type: "string"

    - question: "nullmailer/defaultdomain"
      value: "rocketware.co.uk"
      type: "string"

    - question: "nullmailer/adminaddr"
      value: ""
      type: "string"

  become: "yes"
  action:

    module: "debconf"
    name: "nullmailer"

    question: "{{ item.question }}"
    value: "{{ item.value }}"
    vtype: "{{ item.type }}"

- name: "install nullmailer packages"
  with_items:

    - "nullmailer"

  become: "yes"
  action:

    module: "apt"
    name: "{{ item }}"

- name: "create nullmailer service directory"
  become: "yes"
  action:

    module: "file"
    path: "/etc/service/nullmailer"
    state: "directory"

- name: "create nullmailer service script"
  become: "yes"
  action:

    module: "template"
    dest: "/etc/service/nullmailer/run"
    src: "nullmailer-service"

    mode: "0755"

# ex: et ts=2 filetype=yaml
