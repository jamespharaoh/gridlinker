---

etcd_clustered: "no"
etcd_secured: "no"

etcd_required: "{{
  etcd_required_clustered
  if etcd_clustered == 'yes'
  else []
}}"

etcd_required_clustered:

  - "etcd_peer_ca_certificate"
  - "etcd_peer_certificate"
  - "etcd_peer_private_key"

  - "etcd_client_ca_certificate"
  - "etcd_client_certificate"
  - "etcd_client_private_key"

etcd_security_config:

  - source: "{{ etcd_peer_ca_certificate }}"
    target: "peer-ca.cert"
    mode: "0644"

  - source: "{{ etcd_peer_certificate }}"
    target: "peer-{{ inventory_hostname }}.cert"
    mode: "0644"

  - source: "{{ etcd_peer_private_key }}"
    target: "peer-{{ inventory_hostname }}.key"
    mode: "0600"

  - source: "{{ etcd_client_ca_certificate }}"
    target: "client-ca.cert"
    mode: "0644"

  - source: "{{ etcd_client_certificate }}"
    target: "client-{{ inventory_hostname }}.cert"
    mode: "0644"

  - source: "{{ etcd_client_private_key }}"
    target: "client-{{ inventory_hostname }}.key"
    mode: "0600"

# ex: et ts=2 filetype=yaml
