---

- include: "cluster-setup.yml"
  tags:
    - "cluster-vpc"
    - "cluster-admin-subnet"
    - "cluster-data-subnet"
    - "cluster-app-subnet"
    - "cluster-admin-dns"
    - "cluster-security-groups"
    - "cluster-jenkins-balancer"
    - "cluster-icinga-balancer"
    - "cluster-deployment-dns"
    - "cluster-dev-dns"

# ---------- vpc

- include: "cluster-vpc.yml"
  tags: "cluster-vpc"

- include: "cluster-admin-subnet.yml"
  tags: "cluster-admin-subnet"

- include: "cluster-data-subnet.yml"
  tags: "cluster-data-subnet"
  when: "cluster != 'ops'"

- include: "cluster-app-subnet.yml"
  tags: "cluster-app-subnet"
  when: "cluster != 'ops'"

- include: "cluster-jenkins-subnet.yml"
  tags: "cluster-jenkins-subnet"
  when: "cluster == 'ops'"

- include: "cluster-security-groups.yml"
  tags: "cluster-security-groups"

# ---------- balancers

- include: "cluster-app-balancer.yml"
  tags: "cluster-app-balancer"
  when: "cluster != 'ops'"

- include: "cluster-admin-balancer.yml"
  tags: "cluster-jenkins-balancer"

# ---------- admin

- include: "cluster-admin-dns.yml"
  tags: "cluster-admin-dns"

# ---------- deployments

- include: "cluster-deployment-dns.yml"
  tags: "cluster-deployment-dns"

# ---------- dev

- include: "cluster-dev-dns.yml"
  tags: "cluster-dev-dns"
  when: "cluster == 'ops' or cluster == 'production'"

# ex: et ts=2 filetype=yaml
