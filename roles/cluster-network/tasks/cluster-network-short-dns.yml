---

- name: "write short dns stack yaml"
  action:
    module: "template"
    src: "cluster-network-short-dns-stack"
    dest: "/home/vagrant/work/{{ cluster }}/short-dns-stack"
  sudo: "yes"
  sudo_user: "vagrant"
  when: "cluster == 'production'"

- name: "create short dns stack"
  action:
    module: "cloudformation"
    stack_name: "{{ cluster }}-short-dns"
    state: "present"
    template: "/home/vagrant/work/{{ cluster }}/short-dns-stack"
    template_format: "yaml"
    aws_access_key: "{{ amazon_accounts [amazon_account].access_key }}"
    aws_secret_key: "{{ amazon_accounts [amazon_account].secret_key }}"
    region: "{{ amazon_region }}"
  sudo: "yes"
  sudo_user: "vagrant"
  when: "cluster == 'production'"

# ex: et ts=2 filetype=yaml
