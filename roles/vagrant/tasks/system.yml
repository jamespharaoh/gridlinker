---

- name: "update system packages"
  action:
    module: "apt"
    upgrade: "dist"
    update_cache: "yes"
  sudo: "yes"
  sudo_user: "root"
  tags: "update"

- name: "remove system packages"
  action:
    module: "apt"
    state: "absent"
    name: "{{ item }}"
    purge: "yes"
  sudo: "yes"
  sudo_user: "root"
  with_items: "vagrant_remove_packages"
  tags: "update"

- name: "install system packages"
  action:
    module: "apt"
    state: "present"
    name: "{{ item }}"
  sudo: "yes"
  sudo_user: "root"
  with_items: "vagrant_install_packages"
  tags: "update"

- name: "setup sudo"
  action:
    module: "template"
    src: "sudoers-ssh-agent"
    dest: "/etc/sudoers.d/ssh-agent"
  sudo: "yes"
  sudo_user: "root"

- name: "install ssh known hosts"
  action:
    module: "template"
    src: "ssh-known-hosts"
    dest: "/etc/ssh/ssh_known_hosts"
  sudo: "yes"
  sudo_user: "root"

- name: "make node command work"
  action:
    module: "alternatives"
    link: "/usr/bin/node"
    name: "node"
    path: "/usr/bin/nodejs"
  sudo: "yes"
  sudo_user: "root"

- name: "install python packages"
  action:
    module: "pip"
    name: "{{ item }}"
  sudo: "yes"
  sudo_user: "root"
  with_items: "vagrant_install_python"
  tags: "update"

- name: "install node packages"
  action:
    module: "npm"
    name: "{{ item }}"
    global: "yes"
  sudo: "yes"
  sudo_user: "root"
  with_items: "vagrant_install_node"
  tags: "update"

# ex: et ts=2 filetype=yaml
