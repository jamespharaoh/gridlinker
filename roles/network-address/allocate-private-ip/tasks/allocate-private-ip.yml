---

- name: "allocate private ip"
  connection: "local"
  action:
    module: "network_address_allocator"
    action: "allocate"
    database_location: "/private-ip"
    start_address: "{{ networks [private_network].alloc_start }}"
    end_address: "{{ networks [private_network].alloc_end }}"
    name: "{{ inventory_hostname }}"
  register: "allocate_ip_result"
  when: "private_address is not defined"

- update_resource:
    "private.address": "{{ allocate_ip_result.address }}"
  when: "private_address is not defined"

# ex: et ts=2 filetype=yaml
