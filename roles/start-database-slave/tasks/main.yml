---

- name: "start database slave"
  action:
    module: "docker"
    name: "{{ cluster_name }}-{{ inventory_hostname }}"
    state: "running"
    image: "{{ docker.registry }}/{{ docker.images.database_slave }}:{{ docker.build }}"
    command: "/start-slave.sh"
    dns:
      - "{{ docker.dns.primary }}"
      - "{{ docker.dns.secondary }}"
    expose:
      - "5432"
    ports:
      - "{{ database.slave.port }}:5432"
    tty: "True"
    stdin_open: "True"
    volumes:
      "{{ data_dir }}/{{ cluster_name }}-{{ inventory_hostname }}:/data"
    env:
      - "DATABASE_MASTER_HOSTNAME=172.17.42.1"
      - "DATABASE_MASTER_PORT={{ database.master.port }}"
