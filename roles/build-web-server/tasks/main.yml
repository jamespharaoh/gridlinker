---

- name: "install web server packages"
  action:
    module: "apt"
    name: "{{ item }}"
  with_items:
   - "apache2"
   - "apachetop"
   - "libapache2-mod-fcgid"
   - "memcached"
   - "php5"
   - "php5-cli"
   - "php5-curl"
   - "php5-fpm"
   - "php5-gd"
   - "php5-mcrypt"
   - "php5-memcache"
   - "php5-memcached"
   - "php5-pgsql"
   - "php-gettext"

- name: "enable apache modules"
  action:
    module: "apache2_module"
    name: "{{ item }}"
  with_items:
   - "actions"
   - "deflate"
   - "env"
   - "proxy"
   - "proxy_fcgi"
   - "rewrite"
   - "ssl"

- name: "create service dir"
  action:
    module: "file"
    path: "/etc/service/{{ item }}"
    state: "directory"
  sudo: "yes"
  with_items:
    - "apache"
    - "memcached"

- name: "create service script"
  action:
    module: "template"
    src: "{{ item }}-service"
    dest: "/etc/service/{{ item }}/run"
    mode: "0755"
  sudo: "yes"
  with_items:
    - "apache"
    - "memcached"

# ex: et ts=2 filetype=yaml
