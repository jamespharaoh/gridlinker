---

# ==================== icinga security

wistla_icinga_security_config:

  - target: "/etc/icinga2/pki/ca.cert"
    source: "{{ icinga_ca_certificate }}"
    user: "root"
    group: "root"
    mode: "0644"

  - target: "/etc/icinga2/pki/{{ inventory_hostname }}.cert"
    source: "{{ icinga_certificate }}"
    user: "root"
    group: "root"
    mode: "0644"

  - target: "/etc/icinga2/pki/{{ inventory_hostname }}.key"
    source: "{{ icinga_private_key }}"
    user: "root"
    group: "icinga"
    mode: "0640"

# ==================== icinga master config

wistla_icinga_master_directories:

  - directory: "/etc/icinga2"
    user: "icinga"
    group: "icinga"
    mode: "0750"

  - directory: "/etc/icinga2/pki"
    user: "icinga"
    group: "icinga"
    mode: "0750"

  - directory: "/etc/icinga2/scripts"
    user: "icinga"
    group: "icinga"
    mode: "0750"

  - directory: "/etc/icinga2/zones.d"
    user: "icinga"
    group: "icinga"
    mode: "0750"

  - directory: "/var/cache/icinga2"
    user: "icinga"
    group: "icinga"
    mode: "0750"

  - directory: "/var/lib/icinga2"
    user: "icinga"
    group: "icinga"
    mode: "0750"

  - directory: "/var/lib/icinga2/api"
    user: "icinga"
    group: "icinga"
    mode: "0750"

  - directory: "/var/lib/icinga2/api/log"
    user: "icinga"
    group: "icinga"
    mode: "0750"

  - directory: "/var/lib/icinga2/api/repository"
    user: "icinga"
    group: "icinga"
    mode: "0750"

  - directory: "/var/lib/icinga2/api/zones"
    user: "icinga"
    group: "icinga"
    mode: "0750"

  - directory: "/var/log/icinga2"
    user: "icinga"
    group: "icinga"
    mode: "0750"

wistla_icinga_master_config_templates:

  - template: "wistla-icinga-master-main"
    target: "/etc/icinga2/icinga2.conf"
    user: "root"
    group: "root"
    mode: "0644"

  - template: "wistla-icinga-master-commands"
    target: "/etc/icinga2/commands.conf"
    user: "root"
    group: "root"
    mode: "0644"

  - template: "wistla-icinga-master-constants"
    target: "/etc/icinga2/constants.conf"
    user: "root"
    group: "root"
    mode: "0644"

  - template: "wistla-icinga-master-hosts"
    target: "/etc/icinga2/hosts.conf"
    user: "root"
    group: "root"
    mode: "0644"

  - template: "wistla-icinga-master-secrets"
    target: "/etc/icinga2/secrets.conf"
    user: "root"
    group: "icinga"
    mode: "0640"

  - template: "wistla-icinga-master-services"
    target: "/etc/icinga2/services.conf"
    user: "root"
    group: "icinga"
    mode: "0640"

  - template: "wistla-icinga-master-notifications"
    target: "/etc/icinga2/notifications.conf"
    user: "root"
    group: "icinga"
    mode: "0640"

  - template: "wistla-icinga-master-templates"
    target: "/etc/icinga2/templates.conf"
    user: "root"
    group: "root"
    mode: "0644"

  - template: "wistla-icinga-master-time-periods"
    target: "/etc/icinga2/time-periods.conf"
    user: "root"
    group: "root"
    mode: "0644"

  - template: "wistla-icinga-master-users"
    target: "/etc/icinga2/users.conf"
    user: "root"
    group: "root"
    mode: "0644"

  - template: "wistla-icinga-master-zones"
    target: "/etc/icinga2/zones.conf"
    user: "root"
    group: "root"
    mode: "0644"

wistla_icinga_master_config_files:

  - target: "/etc/icinga2/scripts/mail"
    source: "wistla-icinga-master-script-mail"
    user: "root"
    group: "root"
    mode: "0755"

wistla_icinga_master_config_links:

  - link: "{{ icinga_core_target }}/etc"
    target: "../../etc"

  - link: "{{ icinga_core_target }}/var"
    target: "../../var"

# ==================== icinga slave config

wistla_icinga_slave_directories:

  - directory: "/etc/icinga2"
    user: "icinga"
    group: "icinga"
    mode: "0750"

  - directory: "/etc/icinga2/pki"
    user: "icinga"
    group: "icinga"
    mode: "0750"

  - directory: "/etc/icinga2/scripts"
    user: "icinga"
    group: "icinga"
    mode: "0750"

  - directory: "/etc/icinga2/zones.d"
    user: "icinga"
    group: "icinga"
    mode: "0750"

  - directory: "/var/cache/icinga2"
    user: "icinga"
    group: "icinga"
    mode: "0750"

  - directory: "/var/lib/icinga2"
    user: "icinga"
    group: "icinga"
    mode: "0750"

  - directory: "/var/lib/icinga2/api"
    user: "icinga"
    group: "icinga"
    mode: "0750"

  - directory: "/var/lib/icinga2/api/log"
    user: "icinga"
    group: "icinga"
    mode: "0750"

  - directory: "/var/lib/icinga2/api/repository"
    user: "icinga"
    group: "icinga"
    mode: "0750"

  - directory: "/var/lib/icinga2/api/zones"
    user: "icinga"
    group: "icinga"
    mode: "0750"

  - directory: "/var/log/icinga2"
    user: "icinga"
    group: "icinga"
    mode: "0750"

wistla_icinga_slave_config_templates:

  - template: "wistla-icinga-slave-main"
    target: "/etc/icinga2/icinga2.conf"
    user: "root"
    group: "root"
    mode: "0644"

  - template: "wistla-icinga-slave-constants"
    target: "/etc/icinga2/constants.conf"
    user: "root"
    group: "root"
    mode: "0644"

  - template: "wistla-icinga-slave-zones"
    target: "/etc/icinga2/zones.conf"
    user: "root"
    group: "root"
    mode: "0644"

wistla_icinga_slave_config_links:

  - link: "{{ icinga_core_target }}/etc"
    target: "../../etc"

  - link: "{{ icinga_core_target }}/var"
    target: "../../var"

# ==================== icinga agent config

wistla_icinga_agent_directories:

  - directory: "/etc/icinga2"
    user: "icinga"
    group: "icinga"
    mode: "0750"

  - directory: "/etc/icinga2/pki"
    user: "icinga"
    group: "icinga"
    mode: "0750"

  - directory: "/etc/icinga2/scripts"
    user: "icinga"
    group: "icinga"
    mode: "0750"

  - directory: "/etc/icinga2/zones.d"
    user: "icinga"
    group: "icinga"
    mode: "0750"

  - directory: "/var/cache/icinga2"
    user: "icinga"
    group: "icinga"
    mode: "0750"

  - directory: "/var/lib/icinga2"
    user: "icinga"
    group: "icinga"
    mode: "0750"

  - directory: "/var/lib/icinga2/api"
    user: "icinga"
    group: "icinga"
    mode: "0750"

  - directory: "/var/lib/icinga2/api/log"
    user: "icinga"
    group: "icinga"
    mode: "0750"

  - directory: "/var/lib/icinga2/api/repository"
    user: "icinga"
    group: "icinga"
    mode: "0750"

  - directory: "/var/lib/icinga2/api/zones"
    user: "icinga"
    group: "icinga"
    mode: "0750"

  - directory: "/var/log/icinga2"
    user: "icinga"
    group: "icinga"
    mode: "0750"

wistla_icinga_agent_config_templates:

  - template: "wistla-icinga-agent-main"
    target: "/etc/icinga2/icinga2.conf"
    user: "root"
    group: "root"
    mode: "0644"

  - template: "wistla-icinga-agent-commands"
    target: "/etc/icinga2/commands.conf"
    user: "root"
    group: "root"
    mode: "0644"

  - template: "wistla-icinga-agent-constants"
    target: "/etc/icinga2/constants.conf"
    user: "root"
    group: "root"
    mode: "0644"

  - template: "wistla-icinga-agent-zones"
    target: "/etc/icinga2/zones.conf"
    user: "root"
    group: "root"
    mode: "0644"

  - template: "wistla-icinga-agent-sudoers"
    target: "/etc/sudoers.d/icinga"
    user: "root"
    group: "root"
    mode: "0644"

wistla_icinga_agent_config_links:

  - link: "{{ icinga_core_target }}/etc"
    target: "../../etc"

  - link: "{{ icinga_core_target }}/var"
    target: "../../var"

# ==================== icinga web config

wistla_icinga_web_config_templates:

  - template: "wistla-icinga-web-authentication"
    target: "/etc/icingaweb2/authentication.ini"
    user: "root"
    group: "icingaweb2"
    mode: "0640"

  - template: "wistla-icinga-web-config"
    target: "/etc/icingaweb2/config.ini"
    user: "root"
    group: "icingaweb2"
    mode: "0640"

  - template: "wistla-icinga-web-resources"
    target: "/etc/icingaweb2/resources.ini"
    user: "root"
    group: "icingaweb2"
    mode: "0640"

  - template: "wistla-icinga-web-roles"
    target: "/etc/icingaweb2/roles.ini"
    user: "root"
    group: "icingaweb2"
    mode: "0640"

  - template: "wistla-icinga-web-monitoring-backends"
    target: "/etc/icingaweb2/modules/monitoring/backends.ini"
    user: "root"
    group: "icingaweb2"
    mode: "0640"

  - template: "wistla-icinga-web-monitoring-config"
    target: "/etc/icingaweb2/modules/monitoring/config.ini"
    user: "root"
    group: "icingaweb2"
    mode: "0640"

  - template: "wistla-icinga-web-monitoring-instances"
    target: "/etc/icingaweb2/modules/monitoring/instances.ini"
    user: "root"
    group: "icingaweb2"
    mode: "0640"

wistla_icinga_web_enabled_modules:

  - "monitoring"

# =================== icinga plugins

wistla_icinga_plugins:

  - name: "check_postfixmailqueue"

# ex: et ts=2 filetype=yaml
