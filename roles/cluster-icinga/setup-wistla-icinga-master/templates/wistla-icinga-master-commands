{{ ansible_warning ['//'] }}

object NotificationCommand "mail-host-notification" {

	import "plugin-notification-command"

	command = [
		SysconfDir + "/icinga2/scripts/mail",
		"host",
	]

	env = {
		NOTIFICATIONTYPE = "$notification.type$"
		HOSTALIAS = "$host.display_name$"
		HOSTADDRESS = "$address$"
		HOSTSTATE = "$host.state$"
		LONGDATETIME = "$icinga.long_date_time$"
		HOSTOUTPUT = "$host.output$"
		NOTIFICATIONAUTHORNAME = "$notification.author$"
		NOTIFICATIONCOMMENT = "$notification.comment$"
		HOSTDISPLAYNAME = "$host.display_name$"
		USEREMAIL = "$user.email$"
	}

}

object NotificationCommand "mail-service-notification" {

	import "plugin-notification-command"

	command = [
		SysconfDir + "/icinga2/scripts/mail",
		"service",
	]

	env = {
		NOTIFICATIONTYPE = "$notification.type$"
		SERVICEDESC = "$service.name$"
		HOSTALIAS = "$host.display_name$"
		HOSTADDRESS = "$address$"
		SERVICESTATE = "$service.state$"
		LONGDATETIME = "$icinga.long_date_time$"
		SERVICEOUTPUT = "$service.output$"
		NOTIFICATIONAUTHORNAME = "$notification.author$"
		NOTIFICATIONCOMMENT = "$notification.comment$"
		HOSTDISPLAYNAME = "$host.display_name$"
		SERVICEDISPLAYNAME = "$service.display_name$"
		USEREMAIL = "$user.email$"
	}

}

object CheckCommand "postfix-mail-queue" {

	import "plugin-check-command"

	command = [ "/etc/icinga2/plugins/check_postfixmailqueue" ]

	arguments = {
		"-w" = "$mailq_warning$"
		"-c" = "$mailq_critical$",
	}

	vars.mailq_warning = 1
	vars.mailq_critical = 5

}

object CheckCommand "check-lxc-container" {

	import "plugin-check-command"

	command = [
		"/opt/wbs-monitoring/check_lxc_container",
	]

	arguments = {
		"--container-name" = "$lxc_container_name$",
		"--critical-state" = "$lxc_critical_state$",
	}

}
