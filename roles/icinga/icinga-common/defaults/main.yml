---

# state

icinga_state: "no"
icinga_needs_restart: "no"

# runtime defaults

icinga_common_name: "{{ identity_name }}"
icinga_alt_dns: [ "{{ icinga_common_name }}" ]  
icinga_alt_ips: []

icinga_database_type: "no"
icinga_database_name: "icinga"
icinga_database_username: "icinga"
icinga_database_password: "no"
icinga_database_initialized: "no"

icinga_ticket_salt: "no"

icinga_ca_certificate: "no"
icinga_certificate: "no"
icinga_private_key: "no"

# installation

icinga_source: "{{ ubuntu_mirror }}/ppa.launchpad.net/formorer/icinga"

# master configuration

icinga_master_directories:

  - directory: "/etc/icinga2/local"
    user: "nagios"
    group: "nagios"
    mode: "0750"

icinga_master_config_templates:

  - template: "icinga-master-commands"
    target: "commands.conf"
    mode: "0644"

  - template: "icinga-master-constants"
    target: "constants.conf"
    mode: "0644"

  - template: "icinga-master-hosts"
    target: "hosts.conf"
    mode: "0644"

  - template: "icinga-master-icinga"
    target: "icinga2.conf"
    mode: "0644"

  - template: "icinga-master-secrets"
    target: "secrets.conf"
    mode: "0600"

  - template: "icinga-master-services"
    target: "services.conf"
    mode: "0644"

  - template: "icinga-master-time-periods"
    target: "time-periods.conf"
    mode: "0644"

  - template: "icinga-master-users"
    target: "users.conf"
    mode: "0644"

  - template: "icinga-master-zones"
    target: "zones.conf"
    mode: "0644"

icinga_master_security_files:

  - source: "{{ icinga_ca_certificate }}"
    target: "pki/ca.cert"
    mode: "0644"

  - source: "{{ icinga_certificate }}"
    target: "pki/{{ identity.name }}.cert"
    mode: "0644"

  - source: "{{ icinga_private_key }}"
    target: "pki/{{ identity.name }}.key"
    mode: "0640"

# agent configuration

icinga_agent_config_templates:

  - template: "icinga-agent-constants"
    target: "constants.conf"
    mode: "0644"

  - template: "icinga-agent-icinga"
    target: "icinga2.conf"
    mode: "0644"

  - template: "icinga-agent-secrets"
    target: "secrets.conf"
    mode: "0600"

  - template: "icinga-agent-zones"
    target: "zones.conf"
    mode: "0644"

icinga_agent_security_files:

  - source: "{{ icinga_ca_certificate }}"
    target: "pki/ca.cert"
    mode: "0644"

  - source: "{{ icinga_certificate }}"
    target: "pki/{{ identity.name }}.cert"
    mode: "0644"

  - source: "{{ icinga_private_key }}"
    target: "pki/{{ identity.name }}.key"
    mode: "0640"

# ex: et ts=2 filetype=yaml
