---

icinga_agent_config_templates:

  - template: "icinga-agent-constants"
    target: "constants.conf"
    mode: "0644"

  - template: "icinga-agent-icinga"
    target: "icinga2.conf"
    mode: "0644"

  - template: "icinga-agent-secrets"
    target: "secrets.conf"
    mode: "0600"

  - template: "icinga-agent-zones"
    target: "zones.conf"
    mode: "0644"

icinga_agent_security_files:

  - source: "{{ icinga_ca_certificate }}"
    target: "pki/ca.cert"
    mode: "0644"

  - source: "{{ icinga_certificate }}"
    target: "pki/{{ identity.name }}.cert"
    mode: "0644"

  - source: "{{ icinga_private_key }}"
    target: "pki/{{ identity.name }}.key"
    mode: "0640"

# ex: et ts=2 filetype=yaml
