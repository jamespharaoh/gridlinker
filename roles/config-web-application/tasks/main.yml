---

- include: "site.yml"
  label: "control"
  prefix: "dp_control"
  suffix: "main"
  config: "apache{{ apache_version }}-control-vhost-main.j2"
  sites:
    - main_domain: "control.datingnode.com"
      enabled: "yes"

- include: "site.yml"
  label: "service"
  prefix: "dp_service"
  suffix: "main"
  config: "apache{{ apache_version }}-service-vhost-main.j2"
  sites: "{{ services }}"

- include: "site.yml"
  label: "api"
  prefix: "dp_service"
  suffix: "api"
  config: "apache{{ apache_version }}-service-vhost-api.j2"
  sites: "{{ services }}"

- include: "site.yml"
  label: "static"
  prefix: "dp_service"
  suffix: "static"
  config: "apache{{ apache_version }}-service-vhost-static.j2"
  sites: "{{ services }}"

- name: "create datingnode-config.json"
  action:
    module: "template"
    src: "datingnode-config"
    dest: "/var/www/datingnode-config.json"
  sudo: "yes"

# ex: et ts=2 filetype=yaml
