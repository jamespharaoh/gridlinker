{{ ansible_warning ['#'] }}

{% if cluster_name in [
	'test',
	'test-2',
	'staging',
	'staging-2',
] %}

server {

	listen 80 default_server;
	listen 8080 proxy_protocol default_server;

	listen 443 ssl http2 default_server;
	listen 8443 ssl http2 proxy_protocol default_server;

	server_name {{ inventory_hostname }};

	ssl_certificate /etc/ssl/certs/ssl-cert-snakeoil.pem;
	ssl_certificate_key /etc/ssl/private/ssl-cert-snakeoil.key;

	location /hello {
		return 200;
	}

}

{% else %}

# no default site for {{ cluster_name }} cluster

{% endif %}

# ex: noet ts=4 filetype=nginx
