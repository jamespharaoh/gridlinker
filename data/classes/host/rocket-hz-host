---

identity:

  name: "rocket-hz-host"
  type: "class"

class:

  namespace: "host"

  groups:

    - "rocket-hz"
    - "icinga-agents"

ansible:

  ssh_host: "{{ public.address }}"
  ssh_user: "root"

ssh:

  hostnames:

    - "{{ identity.name }}"
    - "{{ public.address }}"
    - "{{ private.address }}"

openvpn:

  ca_certificate: "/authority/openvpn/certificate"

etcd:

  version: "2.2.5"
  hostname: "{{ identity.name }}.rocketware.co.uk"

  secured: "yes"
  clustered: "yes"

  peer_authority: "rocket-etcd-peer"
  peer_ca_certificate: "/authority/rocket-etcd-peer/certificate"

  client_authority: "rocket-etcd-client"
  client_ca_certificate: "/authority/rocket-etcd-client/certificate"

  initial_cluster_state: "new"
  initial_cluster: "{{ [
    'rocket-hz-host-1=https://rocket-hz-host-1.rocketware.co.uk:2380',
    'rocket-hz-host-2=https://rocket-hz-host-2.rocketware.co.uk:2380',
  ] | join (',') }}"

icinga_core:

  master: "{{ super_cluster.icinga_master }}"

  authority: "rocket-icinga"
  ca_certificate: "/authority/{{ icinga_core_authority }}/certificate"

  alt_dns:

    - "{{ identity_name }}"
    - "{{ identity_name }}.vpn"

icinga_endpoint:

  host: "{{ identity_name }}.vpn"
  external: "{{ identity_name }}.vpn"

icinga_host:

  address: "{{ identity_name }}.vpn"

  vars:

    - name: "type"
      type: "string"
      value: "dedicated"

    - name: "notification_groups"
      type: "array"
      value:

        - type: "string"
          value: "admins"

    - name: "disks"
      key: "Disk root"
      type: "object"
      value:

        - name: "disk_partition"
          type: "string"
          value: "/"

    - name: "disks"
      key: "Disk boot"
      type: "object"
      value:

        - name: "disk_partition"
          type: "string"
          value: "/boot"

ubuntu:

  system_packages_class:

    - name: "bcache-tools"
      state: "present"

    - name: "bridge-utils"
      state: "present"

    - name: "ebtables"
      state: "present"

    - name: "qemu-kvm"
      state: "present"

    - name: "thin-provisioning-tools"
      state: "present"

# ex: et ts=2 filetype=yaml
