---

ubuntu_sources_extra:

  - url: "http://apt.postgresql.org/pub/repos/apt/"
    source: "trusty-pgdg"
    repositories:

      - "main"

ubuntu_keys_extra:

  - file: "security/apt-keys/postgresql-apt-key"

my_system_packages:

  - name: "build-essential"
    state: "present"

  - name: "graphicsmagick"
    state: "present"

  - name: "imagemagick"
    state: "present"

  - name: "iptables"
    state: "present"

  - name: "libav-tools"
    state: "present"

  - name: "postgresql-client-9.5"
    state: "present"

node_deploy_projects:

  - name: "wistla-api-server"
    type: "nodejs"
    nodejs_main: "index.js"
    nodejs_interpreter: "node --harmony"
    nodejs_debug: "node debug --debug-brk=5005 --harmony"
    excludes:

      - "/config/local.yaml"

    configs:

      - target: "local.yaml"
        source: "wistla-api-server-local.yaml"

  - name: "wistla-blob"
    type: "nodejs"

  - name: "wistla-media"
    type: "nodejs"

  - name: "wistla-pubsub"
    type: "nodejs"

  - name: "wistla-raml-api"
    type: "nodejs"

  - name: "wistla-raml-server"
    type: "nodejs"

  - name: "wistla-raml-to-api"
    type: "nodejs"

  - name: "wistla-data-process"
    type: "nodejs"
    excludes:

      - "/config/local.yaml"

    configs:

      - target: "local.yaml"
        source: "wistla-api-server-local.yaml"

  - name: "wistla-db"
    type: "nodejs"

  - name: "wistla-util"
    type: "nodejs"

  - name: "wistla-test"
    type: "nodejs"

  # todo: remove when this is running in the "environments"
  # todo: container
  - name: "wistla-db-schema"
    type: "nodejs"
    excludes:

      - "/config/local.yaml"

    configs:

      - target: "local.yaml"
        source: "wistla-db-schema-local.yaml"

nodejs_version: "{{ deployment.nodejs_version }}"

nodejs_packages: []

# ex: et ts=2 filetype=yaml
