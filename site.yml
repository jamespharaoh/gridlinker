---

# configure vagrant box

- hosts: "vagrant"
  gather_facts: "no"
  roles: [ "vagrant" ]

# create template

- hosts: "template"
  gather_facts: "no"
  roles: [ "create", "template" ]

# create mongo

- hosts: "mongo-template"
  gather_facts: "no"
  roles: [ "clone", "template", "mongo" ]
  tags: "mongo"

- hosts: "mongo-host"
  gather_facts: "no"
  roles: [ "stop" ]

- hosts: "mongo-host"
  gather_facts: "no"
  roles: [ "destroy" ]
  serial: 1

- hosts: "mongo-host"
  gather_facts: "no"
  roles: [ "clone" ]
  serial: 1

- hosts: "mongo-host"
  gather_facts: "no"
  roles: [ "start" ]

# create api

- hosts: "api-template"
  gather_facts: "no"
  roles: [ "clone", "template", "api" ]

- hosts: "api-host"
  gather_facts: "no"
  roles: [ "stop" ]

- hosts: "api-host"
  gather_facts: "no"
  roles: [ "destroy" ]
  serial: 1

- hosts: "api-host"
  gather_facts: "no"
  roles: [ "clone" ]
  serial: 1

- hosts: "api-host"
  gather_facts: "no"
  roles: [ "start" ]

# create web

- hosts: "web-template"
  gather_facts: "no"
  roles: [ "clone", "template", "web" ]

- hosts: "web-host"
  gather_facts: "no"
  roles: [ "stop" ]

- hosts: "web-host"
  gather_facts: "no"
  roles: [ "destroy" ]
  serial: 1

- hosts: "web-host"
  gather_facts: "no"
  roles: [ "clone" ]
  serial: 1

- hosts: "web-host"
  gather_facts: "no"
  roles: [ "start" ]
  tags: "web"

# create load

- hosts: "load-template"
  gather_facts: "no"
  roles: [ "clone", "template", "load" ]

- hosts: "load-host"
  gather_facts: "no"
  roles: [ "stop" ]

- hosts: "load-host"
  gather_facts: "no"
  roles: [ "destroy" ]
  serial: 1

- hosts: "load-host"
  gather_facts: "no"
  roles: [ "clone" ]
  serial: 1

- hosts: "load-host"
  gather_facts: "no"
  roles: [ "start" ]
