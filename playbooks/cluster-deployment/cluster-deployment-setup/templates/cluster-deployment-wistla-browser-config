{{ ansible_warning ['//'] }}

var ROOT = process.env.HOME + '/wistla-browser';
var config = require(ROOT + '/config/config.global');

// public urls

config.adminUrl = 'https://{{ cluster_deployment_alias.admin_domain }}';
config.apiUrl = 'https://{{ cluster_deployment_alias.api_domain }}';
config.assetsUrl = 'https://{{ cluster_deployment_alias.assets_domain }}';
config.shortUrl = 'https://{{ cluster_deployment_alias.short_domain }}';
config.webUrl = 'https://{{ cluster_deployment_alias.web_domain }}';

// private urls

config.apiPrivate = '{{ [
	'http://api.',
	cluster_deployment.name,
	'-load-',
	instance_zone,
	'-',
	instance_index,
] | join }}';

// email

config.emailDomain = '{{ cluster_deployment.email_domain }}';

// Deep link url scheme for use in sending out emails.

config.urlScheme = '{{ cluster_deployment.url_scheme }}';

// facebook config

{% set facebook_app = facebook_apps [cluster_deployment.facebook_app] %}

config.facebook.appId = '{{ facebook_app.app_id }}';

// android config

{% set android_app = android_apps [cluster_deployment.android_app] %}

config.android = {
	appId: '{{ android_app.app_id }}',
	appStoreUrlWeb: '{{ android_app.app_store_url_web }}',
	appStoreUrlMobile: '{{ android_app.app_store_url_mobile }}',
};

// google config

{% set google_project = google_projects [cluster_deployment.google_project] %}

if (! config.authentication || typeof config.authentication !== 'object') {
	config.authentication = {};
}

if (! config.authentication.google || typeof config.authentication.google !== 'object') {
	config.authentication.google = {};
}

config.authentication.google.name = '{{ google_project.auth_name }}';
config.authentication.google.api_key = '{{ google_project.auth_api_key }}';
config.authentication.google.client_id = '{{ google_project.auth_client_id }}';
config.authentication.google.client_secret = '{{ google_project.auth_client_secret }}';

module.exports = config;

// ex: noet ts=4 filetype=javascript
