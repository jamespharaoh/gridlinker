---

- when: "amazon_instance_state == 'running'"
  block:

    - name: "enable lxc container startup"
      become: "yes"
      action:

        module: "file"
        path: "/etc/init/lxc.override"
        state: "absent"

    - name: "start lxc containers"
      become: "yes"
      action:

        module: "service"
        name: "lxc"
        state: "started"

- when: "amazon_instance_state == 'standby'"
  block:

    - name: "disable lxc container startup"
      become: "yes"
      action:

        module: "copy"
        dest: "/etc/init/lxc.override"
        content: "manual"

    - name: "stop lxc containers"
      become: "yes"
      action:

        module: "service"
        name: "lxc"
        state: "stopped"

# ex: et ts=2 filetype=yaml
