---

# TODO generate this file

- hosts: "cluster-production-app"
  serial: "1"
  roles:

    # production-a

    - role: "cluster-deployment-playbook"
      when: "amazon_instance_state == 'running'"
      cluster_deployment_name: "production-a"
      cluster_deployment_playbook_name: "node-start"
      tags: [ "cluster-deployment", "production-a" ]

    - role: "cluster-deployment-playbook"
      when: "amazon_instance_state == 'standby'"
      cluster_deployment_name: "production-a"
      cluster_deployment_playbook_name: "node-stop"
      tags: [ "cluster-deployment", "production-a" ]

    # production-b

    - role: "cluster-deployment-playbook"
      when: "amazon_instance_state == 'running'"
      cluster_deployment_name: "production-b"
      cluster_deployment_playbook_name: "node-start"
      tags: [ "cluster-deployment", "production-b" ]

    - role: "cluster-deployment-playbook"
      when: "amazon_instance_state == 'standby'"
      cluster_deployment_name: "production-b"
      cluster_deployment_playbook_name: "node-stop"
      tags: [ "cluster-deployment", "production-b" ]

- hosts: "cluster-production-data"
  serial: "1"
  roles:

    # production

    - role: "cluster-deployment-playbook"
      when: "amazon_instance_state == 'running'"
      cluster_deployment_name: "production"
      cluster_deployment_playbook_name: "node-start"
      tags: [ "cluster-deployment", "production" ]

    - role: "cluster-deployment-playbook"
      when: "amazon_instance_state == 'standby'"
      cluster_deployment_name: "production"
      cluster_deployment_playbook_name: "node-stop"
      tags: [ "cluster-deployment", "production" ]

- hosts: "cluster-staging-app"
  roles:

    # staging-a

    - role: "cluster-deployment-playbook"
      when: "amazon_instance_state == 'running'"
      cluster_deployment_name: "staging-a"
      cluster_deployment_playbook_name: "node-start"
      tags: [ "cluster-deployment", "staging-a" ]

    - role: "cluster-deployment-playbook"
      when: "amazon_instance_state == 'standby'"
      cluster_deployment_name: "staging-a"
      cluster_deployment_playbook_name: "node-stop"
      tags: [ "cluster-deployment", "staging-a" ]

    # staging-b

    - role: "cluster-deployment-playbook"
      when: "amazon_instance_state == 'running'"
      cluster_deployment_name: "staging-b"
      cluster_deployment_playbook_name: "node-start"
      tags: [ "cluster-deployment", "staging-b" ]

    - role: "cluster-deployment-playbook"
      when: "amazon_instance_state == 'standby'"
      cluster_deployment_name: "staging-b"
      cluster_deployment_playbook_name: "node-stop"
      tags: [ "cluster-deployment", "staging-b" ]

- hosts: "cluster-staging-data"
  roles:

    # staging

    - role: "cluster-deployment-playbook"
      when: "amazon_instance_state == 'running'"
      cluster_deployment_name: "staging"
      cluster_deployment_playbook_name: "start"
      tags: [ "cluster-deployment", "staging" ]

    - role: "cluster-deployment-playbook"
      when: "amazon_instance_state == 'standby'"
      cluster_deployment_name: "staging"
      cluster_deployment_playbook_name: "stop"
      tags: [ "cluster-deployment", "staging" ]

- hosts: "cluster-test-app"
  roles:

    - role: "cluster-deployment-playbook"
      when: "amazon_instance_state == 'running'"
      cluster_deployment_name: "test-everest"
      cluster_deployment_playbook_name: "restart"
      tags: [ "cluster-deployment", "test-everest" ]

    - role: "cluster-deployment-playbook"
      when: "amazon_instance_state == 'running'"
      cluster_deployment_name: "test-k2"
      cluster_deployment_playbook_name: "restart"
      tags: [ "cluster-deployment", "test-k2" ]

    - role: "cluster-deployment-playbook"
      when: "amazon_instance_state == 'running'"
      cluster_deployment_name: "test-montblanc"
      cluster_deployment_playbook_name: "restart"
      tags: [ "cluster-deployment", "test-montblanc" ]

    - role: "cluster-deployment-playbook"
      when: "amazon_instance_state == 'running'"
      cluster_deployment_name: "test-erebus"
      cluster_deployment_playbook_name: "restart"
      tags: [ "cluster-deployment", "test-erebus" ]

    - role: "cluster-deployment-playbook"
      when: "amazon_instance_state == 'running'"
      cluster_deployment_name: "test-fitzroy"
      cluster_deployment_playbook_name: "restart"
      tags: [ "cluster-deployment", "test-fitzroy" ]

# ex: et ts=2 filetype=yaml
