{%- print ansible_warning ['#'], '\n' -%}

{%- print '\n' -%}

{%- for name, lines in ssh_host_keys.general.items () -%}

	{%- print [
		name,
		lines | join,
	] | join (' '), '\n' -%}

{%- endfor -%}

{%- print '\n' -%}

{%- for other_deployment_name in dev_deployment_names
	if other_deployment_name in ssh_host_keys.dev -%}

	{%- set other_deployment = deployments [other_deployment_name] -%}

	{%- print [
		[
			'wistla-' + other_deployment_name + '-dev',
			other_deployment.bridge_network + '.0.1',
		] | join (','),
		ssh_host_keys.dev [other_deployment_name] | join,
	] | join (' '), '\n' -%}

{%- endfor -%}

{%- print '\n' -%}

{%- for host_name in groups ['cluster-host'] -%}

	{%- set host = hostvars [host_name] -%}
	{%- set instance_type = host.instance_type -%}
	{%- set instance_zone = host.instance_zone -%}
	{%- set instance_index = host.instance_index | string -%}
	{%- set instance_cluster_name = host.cluster_name -%}
	{%- set instance_cluster = clusters [instance_cluster_name] -%}

	{%- for key_type in [ 'rsa', 'ecdsa' ] -%}
	{%- if 'ssh_host_key_' + key_type in host
		and host ['ssh_host_key_' + key_type] -%}

		{%- print [
			[
				host_name,
				host_name + '.' + instance_cluster.main_domain,
				instance_zone + '.admin.' + instance_cluster.main_domain,
				host.private_address,
			] | join (','),
			host ['ssh_host_key_' + key_type],
		] | join (' '), '\n' -%}

	{%- endif -%}
	{%- endfor -%}

{%- endfor -%}

{%- print '\n' -%}

{%- for ssh_host_key_extra in ssh_host_keys_extra | default ([]) -%}

	{%- print ssh_host_key_extra, '\n' -%}

{%- endfor -%}
