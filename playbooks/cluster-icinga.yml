---

# ==================== icinga

- hosts: "cluster-ops-network"
  roles:

    - "icinga-core-cluster-prepare"

- hosts:

    - "cluster-admin:&cluster-instance-active"
    - "cluster-app:&cluster-instance-active"
    - "cluster-data:&cluster-instance-active"
    - "cluster-jenkins:&cluster-instance-active"

  roles:

    - "icinga-core-install"
    - "install-wistla-icinga-plugins"

- hosts: "cluster-ops-network"
  roles:

    - "icinga-core-cluster-setup"

- hosts: "wistla-ops-admin-a:&cluster-instance-active"
  roles:

    - "setup-wistla-icinga-master"
    - "icinga-core-control"

- hosts:

    - "cluster-admin:&cluster-instance-active:!wistla-ops-admin-a"
    - "cluster-app:&cluster-instance-active"
    - "cluster-data:&cluster-instance-active"
    - "cluster-jenkins:&cluster-instance-active"

  roles:

    - "setup-wistla-icinga-agent"
    - "icinga-core-control"

# ==================== icinga web

- hosts: "cluster-ops-admin:&cluster-instance-active"
  roles:

    - "icinga-web-core-install"

- hosts: "cluster-ops-network"
  roles:

    - "icinga-web-core-cluster-setup"

- hosts: "cluster-ops-admin:&cluster-instance-active"
  roles:

    - "icinga-web-core-setup"

# ==================== wbs monitoring

- hosts:

    - "cluster-admin:&cluster-instance-active"
    - "cluster-app:&cluster-instance-active"
    - "cluster-data:&cluster-instance-active"
    - "cluster-jenkins:&cluster-instance-active"

  roles:

    - "wbs-monitoring"

# ex: et ts=2 filetype=yaml
