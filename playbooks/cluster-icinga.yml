---

# ==================== icinga

- hosts: "cluster-ops-network"
  roles:

    - "icinga-core-database-prepare"

- hosts:

    - "cluster-admin"

  roles:

    - "icinga-core-install"
    - "install-wistla-icinga-plugins"

- hosts:

    - "cluster-app"
    - "cluster-data"
    - "cluster-jenkins"

  roles:

    - "icinga-core-install"
    - "install-wistla-icinga-plugins"

- hosts: "cluster-ops-network"
  roles:

    - "icinga-core-database-setup"

- hosts: "wistla-ops-admin-a"
  roles:

    - "setup-wistla-icinga-master"
    - "icinga-core-control"

- hosts:

    - "cluster-admin:!wistla-ops-admin-a"
    - "cluster-app"
    - "cluster-data"
    - "cluster-jenkins"

  roles:

    - "setup-wistla-icinga-agent"
    - "icinga-core-control"

# ==================== icinga web

- hosts: "cluster-ops-admin:&cluster-instance-active"
  roles:

    - "icinga-web-core-install"

- hosts: "cluster-ops-network"
  roles:

    - "icinga-web-core-database-setup"

- hosts: "cluster-ops-admin:&cluster-instance-active"
  roles:

    - "icinga-web-core-setup"
    - "icinga-web-graphite"

# =================== graphite

- hosts: "cluster-ops-admin:&cluster-instance-active"
  roles:

    - "graphite-carbon"
    - "graphite-web"

# ex: et ts=2 filetype=yaml
